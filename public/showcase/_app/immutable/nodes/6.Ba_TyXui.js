import{a as x,f as g}from"../chunks/zz4pAW5t.js";import{p as Fa,d as F,D as ta,t as I,a as Na,c as r,s as i,r as n,F as T,g as e,G as sa,b as h}from"../chunks/DdHHCz2d.js";import{d as ka,s as b,a as na,e as N}from"../chunks/B1nNSMqB.js";import{i as L}from"../chunks/BJJAIwca.js";import{e as P,a as ra,b as Oa}from"../chunks/0vhbyHiM.js";import{m as Ka}from"../chunks/D-SIh8RA.js";import{A as Aa,U as la}from"../chunks/BmJEuGFb.js";import{S as Ga}from"../chunks/CRdhvj4_.js";import{X as ia}from"../chunks/Bx42O4zn.js";import{G as Ma}from"../chunks/Chnw2pnU.js";import{F as $a}from"../chunks/CK89AMs3.js";var Ja=g('<span class="badge-builtin svelte-1nux4an">内置</span>'),Ua=g('<span class="nav-item-count svelte-1nux4an"> </span>'),ja=g('<button><span class="nav-item-name svelte-1nux4an"> </span> <!> <!></button>'),Ba=g('<span class="badge-auto svelte-1nux4an">自动</span>'),Ca=g('<div draggable="true" role="option"><span class="drag-handle svelte-1nux4an"><!></span> <!> <span class="file-name svelte-1nux4an"> </span> <!> <span class="file-size svelte-1nux4an"> </span> <button class="btn-icon svelte-1nux4an" aria-label="移除"><!></button></div>'),Ea=g('<div class="section svelte-1nux4an"><div class="section-header group-header svelte-1nux4an"><h3 class="svelte-1nux4an"> </h3> <span class="section-count svelte-1nux4an"> </span></div> <div class="file-list svelte-1nux4an"></div></div>'),La=g('<div class="page svelte-1nux4an"><div class="page-header svelte-1nux4an"><button class="btn-back svelte-1nux4an" aria-label="返回编辑器"><!></button> <h2 class="svelte-1nux4an">批量转换</h2></div> <div class="batch-layout svelte-1nux4an"><nav class="template-nav svelte-1nux4an"><div class="nav-search svelte-1nux4an"><!> <input type="text" placeholder="搜索模板…" disabled="" class="svelte-1nux4an"/></div> <div class="nav-list svelte-1nux4an"></div></nav> <div class="batch-content svelte-1nux4an"><div class="action-bar svelte-1nux4an"><button class="btn-action svelte-1nux4an"><!> <span>选择文件</span></button> <button class="btn-action subtle svelte-1nux4an"><!> <span>清空</span></button> <button class="btn-convert svelte-1nux4an"><span> </span></button></div> <div class="drop-zone compact svelte-1nux4an"><!> <span>拖拽更多文件或 ZIP 到此处</span></div> <!></div></div></div>');function ee(oa,va){Fa(va,!0);const X=[{name:"gongwen",displayName:"类公文模板",builtin:!0},{name:"jiaoan-shicao",displayName:"实操教案模板",builtin:!0}];let y=F(ta(Ka.filter(a=>a.template).map((a,s)=>({id:`file-${s}`,name:a.name,templateId:a.template,autoDetected:a.autoDetected,size:Math.floor(Math.random()*20+2)*1024})))),Z=F("gongwen"),p=F(ta(new Set)),da=sa(()=>{const a=new Map;for(const t of e(y))a.has(t.templateId)||a.set(t.templateId,[]),a.get(t.templateId).push(t);const s=[];for(const[t,o]of a){const v=X.find(d=>d.name===t);s.push({templateId:t,displayName:v?.displayName||t,files:o})}return s});function k(a){return e(y).filter(s=>s.templateId===a).length}function ca(a,s){const t=new Set(e(p));if(s.metaKey||s.ctrlKey)t.has(a)?t.delete(a):t.add(a);else if(s.shiftKey&&e(p).size>0){const o=e(y).map(c=>c.id),v=[...e(p)].pop(),d=o.indexOf(v),u=o.indexOf(a),[S,z]=d<u?[d,u]:[u,d];for(let c=S;c<=z;c++)t.add(o[c])}else t.clear(),t.add(a);h(p,t,!0)}let D=F(null);function pa(a,s){const t=e(p).has(s)?[...e(p)]:[s];a.dataTransfer?.setData("application/x-presto-files",JSON.stringify(t)),a.dataTransfer.effectAllowed="move"}function ua(a,s){a.dataTransfer?.types.includes("application/x-presto-files")&&(a.preventDefault(),a.dataTransfer.dropEffect="move",h(D,s,!0))}function ma(a){e(D)===a&&h(D,null)}function fa(a,s){a.preventDefault(),h(D,null);const t=a.dataTransfer?.getData("application/x-presto-files");if(t)try{const o=JSON.parse(t),v=new Set(o);h(y,e(y).map(d=>v.has(d.id)?{...d,templateId:s,autoDetected:!1}:d),!0),h(p,new Set,!0)}catch{}}var O=La(),K=r(O),q=r(K),_a=r(q);Aa(_a,{size:16}),n(q),T(2),n(K);var H=i(K,2),A=r(H),G=r(A),xa=r(G);Ga(xa,{size:14}),T(2),n(G);var Q=i(G,2);P(Q,21,()=>X,a=>a.name,(a,s)=>{var t=ja();let o;var v=r(t),d=r(v,!0);n(v);var u=i(v,2);{var S=l=>{var _=Ja();x(l,_)};L(u,l=>{e(s).builtin&&l(S)})}var z=i(u,2);{var c=l=>{var _=Ua(),w=r(_,!0);n(_),I(j=>b(w,j),[()=>k(e(s).name)]),x(l,_)},m=sa(()=>k(e(s).name)>0);L(z,l=>{e(m)&&l(c)})}n(t),I(l=>{o=ra(t,1,"nav-item svelte-1nux4an",null,o,l),b(d,e(s).displayName)},[()=>({active:e(Z)===e(s).name,"drop-target":e(D)===e(s).name,"has-files":k(e(s).name)>0})]),na("click",t,()=>h(Z,e(s).name,!0)),N("dragover",t,l=>ua(l,e(s).name)),N("dragleave",t,()=>ma(e(s).name)),N("drop",t,l=>fa(l,e(s).name)),x(a,t)}),n(Q),n(A);var R=i(A,2),M=r(R),$=r(M),ha=r($);la(ha,{size:14}),T(2),n($);var J=i($,2),ba=r(J);ia(ba,{size:14}),T(2),n(J);var V=i(J,2),W=r(V),ga=r(W);n(W),n(V),n(M);var U=i(M,2),ya=r(U);la(ya,{size:14}),T(2),n(U);var za=i(U,2);P(za,17,()=>e(da),a=>a.templateId,(a,s)=>{var t=Ea(),o=r(t),v=r(o),d=r(v,!0);n(v);var u=i(v,2),S=r(u,!0);n(u),n(o);var z=i(o,2);P(z,21,()=>e(s).files,c=>c.id,(c,m)=>{var l=Ca();let _;var w=r(l),j=r(w);Ma(j,{size:12}),n(w);var Y=i(w,2);$a(Y,{size:14});var B=i(Y,2),Da=r(B,!0);n(B);var aa=i(B,2);{var Sa=f=>{var E=Ba();x(f,E)};L(aa,f=>{e(m).autoDetected&&f(Sa)})}var C=i(aa,2),wa=r(C);n(C);var ea=i(C,2),Ia=r(ea);ia(Ia,{size:12}),n(ea),n(l),I((f,E,Ta)=>{_=ra(l,1,"file-row batch-file-row svelte-1nux4an",null,_,f),Oa(l,"aria-selected",E),b(Da,e(m).name),b(wa,`${Ta??""} KB`)},[()=>({selected:e(p).has(e(m).id)}),()=>e(p).has(e(m).id),()=>(e(m).size/1024).toFixed(1)]),na("click",l,f=>ca(e(m).id,f)),N("dragstart",l,f=>pa(f,e(m).id)),x(c,l)}),n(z),n(t),I(()=>{b(d,e(s).displayName),b(S,e(s).files.length)}),x(a,t)}),n(R),n(H),n(O),I(()=>b(ga,`转换全部 (${e(y).length??""})`)),x(oa,O),Na()}ka(["click"]);export{ee as component};
